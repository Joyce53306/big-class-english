<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <link rel="manifest" href="manifest.json">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤§ç­å£èªªç·´ç¿’</title>
    <style>
        body { font-family: sans-serif; text-align: center; background-color: #FFF9E3; padding: 20px; }
        .card { background: white; border-radius: 20px; padding: 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); max-width: 600px; margin: auto; }
        select { font-size: 16px; padding: 10px; width: 100%; margin: 10px 0; border-radius: 10px; border: 1px solid #ddd; }
        .sentence-box { font-size: 20px; color: #333; font-weight: bold; margin: 25px 0; padding: 20px; background: #F9F9F9; border-left: 5px solid #FFD700; border-radius: 5px; line-height: 1.5; min-height: 60px; display: flex; align-items: center; justify-content: center; }
        .btn-group { display: flex; justify-content: center; gap: 20px; margin-top: 10px; }
        .btn { border: none; width: 70px; height: 70px; border-radius: 50%; font-size: 28px; cursor: pointer; color: white; transition: 0.2s; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .btn:active { transform: scale(0.9); }
        #play-example { background: #FFD700; color: #444; } 
        #record-btn { background: #42A5F5; }
        #play-mine { background: #FF5252; display: none; } 
        #status { margin-top: 25px; font-weight: bold; color: #555; font-size: 18px; }
    </style>
</head>
<body>
    <div class="card">
        <h2 style="color: #E67E22;">ğŸ“ å¤§ç­å£èªªæŒ‘æˆ° (L1-L10)</h2>
        <select id="lesson-select" onchange="initLesson()"></select>
        <select id="sentence-select" onchange="showSentence()"></select>
        
        <div class="sentence-box" id="display-text">è¼‰å…¥ä¸­...</div>

        <div class="btn-group">
            <button id="play-example" class="btn" title="è½ç¯„ä¾‹">ğŸ”Š</button>
            <button id="record-btn" class="btn" title="éŒ„éŸ³">ğŸ¤</button>
            <button id="play-mine" class="btn" title="è½è‡ªå·±">ğŸ‘‚</button>
        </div>
        
        <p id="status">é»æ“Šé»ƒè‰²å–‡å­è½è€å¸«å”¸</p>
    </div>

    <script>
        const curriculum = {
            "Lesson 1: Jobs": ["I want to be a chef.", "I want to be a doctor.", "I want to be a teacher.", "I want to be a pilot.", "I want to be an engineer.", "I want to be a ballerina.", "I want to be a nurse.", "I want to be a firefighter."],
            "Lesson 2: Sports": ["I tried to kick the ball. I canâ€™t kick the ball.", "I tried to catch the ball. I canâ€™t catch the ball.", "I tried to spike the ball. I canâ€™t spike the ball.", "I tried to throw the ball. I canâ€™t throw the ball."],
            "Lesson 3: Which is better?": ["Toothpaste is better.", "Soap is better.", "Broccoli is better.", "Water is better.", "A brush is better."],
            "Lesson 4: Politeness": ["May I please have some soup? Yes, please.", "May I please have some rice? Yes, please."],
            "Lesson 5: Weather": ["Itâ€™s sunny.", "Itâ€™s rainy.", "Itâ€™s snowy.", "Itâ€™s cloudy.", "Itâ€™s windy.", "Itâ€™s stormy.", "Itâ€™s partly cloudy."],
            "Lesson 6: Animals": ["Look! I see a monkey eating bananas.", "Look! I see a giraffe dancing with a sandwich.", "Look! I see a kangaroo hopping with peanuts.", "Look! I see a hippo swimming.", "Look! I see an elephant throwing popcorn."],
            "Lesson 7: Art Class": ["I cut with scissors.", "I color with markers.", "I draw with crayons.", "I paste with glue.", "I paint with a brush."],
            "Lesson 8: Festivals": ["On Chinese New Year we will watch the lion and dragon dance.", "On Easter we will hide eggs and dress like rabbits.", "On Thanksgiving we will eat a huge turkey and bake pies.", "On Valentineâ€™s Day we will give each other flowers and chocolate.", "On Halloween we will dress up in costumes and say Trick or Treat!", "On Christmas we will decorate Christmas tree and give each other gifts."],
            "Lesson 9: Shopping": ["I will buy a popsicle.", "I will buy a bag.", "I will buy shoes.", "I will buy a hat."],
            "Lesson 10: My Garden": ["If I had a garden, I would grow rainbow lollipops.", "Rainbow lollipops would make me colorful.", "If I had a garden, I would grow dancing flowers.", "Dancing flowers would make me dance.", "If I had a garden, I would grow chocolate turtles.", "Chocolate turtles would make me exercise.", "I had a garden I would grow a silly puppy.", "A silly puppy would make me laugh."]
        };

        const lS = document.getElementById('lesson-select');
        const sS = document.getElementById('sentence-select');
        const disp = document.getElementById('text-to-say');
        const status = document.getElementById('status');
        let mediaRecorder;
        let audioChunks = [];
        let audioUrl;

        // åˆå§‹åŒ–é¸å–®
        for (let l in curriculum) { lS.options.add(new Option(l, l)); }
        function initLesson() {
            sS.innerHTML = "";
            curriculum[lS.value].forEach(s => sS.options.add(new Option(s, s)));
            showSentence();
        }
        function showSentence() { 
            document.getElementById('display-text').innerText = sS.value; 
            status.innerText = "å…ˆè½ç¯„ä¾‹å†å”¸å”¸çœ‹";
            document.getElementById('play-mine').style.display = 'none';
        }
        initLesson();

        // 1. æ’­æ”¾ç¯„ä¾‹
        document.getElementById('play-example').onclick = () => {
            const utter = new SpeechSynthesisUtterance(document.getElementById('display-text').innerText);
            utter.lang = 'en-US';
            utter.rate = 0.75; // å¤§ç­å¥å­è¼ƒé•·ï¼Œèªé€Ÿèª¿æ…¢è‡³ 0.75
            window.speechSynthesis.speak(utter);
            status.innerText = "è½å®Œç¯„ä¾‹äº†ï¼Œç¾åœ¨æ›ä½ å”¸ï¼";
        };

        // 2. éŒ„éŸ³
        document.getElementById('record-btn').onclick = async function() {
            if (!mediaRecorder || mediaRecorder.state === 'inactive') {
                const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                mediaRecorder = new MediaRecorder(stream);
                audioChunks = [];
                mediaRecorder.ondataavailable = e => audioChunks.push(e.data);
                mediaRecorder.onstop = () => {
                    const audioBlob = new Blob(audioChunks, { type: 'audio/wav' });
                    audioUrl = URL.createObjectURL(audioBlob);
                    document.getElementById('play-mine').style.display = 'inline-block';
                    status.innerText = "éŒ„éŸ³å®Œæˆï¼é»ç´…è€³æœµè½çœ‹çœ‹";
                };
                mediaRecorder.start();
                this.style.backgroundColor = "#FF5722";
                status.innerText = "æ­£åœ¨è½ä½ èªªè©±... (èªªå®Œå†é»ä¸€æ¬¡)";
            } else {
                mediaRecorder.stop();
                this.style.backgroundColor = "#42A5F5";
            }
        };

        // 3. è½è‡ªå·±
        document.getElementById('play-mine').onclick = () => {
            if (audioUrl) {
                const audio = new Audio(audioUrl);
                audio.play();
                status.innerText = "æ­£åœ¨æ’­æ”¾ä½ çš„è²éŸ³...";
            }
        };
    </script>
</body>
</html>
